{"version":3,"sources":["../src/security/index.ts"],"sourcesContent":["import { createHash, randomBytes } from 'crypto';\n\nexport interface SecurityConfig {\n  rateLimitRequests: number;\n  rateLimitWindowMs: number;\n  encryptionKey: string;\n  jwtSecret: string;\n}\n\nclass SecurityService {\n  private static instance: SecurityService;\n  private config: SecurityConfig;\n\n  private constructor(config: SecurityConfig) {\n    this.config = config;\n  }\n\n  static getInstance(config: SecurityConfig): SecurityService {\n    if (!SecurityService.instance) {\n      SecurityService.instance = new SecurityService(config);\n    }\n    return SecurityService.instance;\n  }\n\n  // Input validation and sanitization\n  sanitizeUserInput(input: any): any {\n    throw new Error('sanitizeUserInput not implemented.');\n  }\n\n  // Rate limiting\n  getRateLimiter() {\n    throw new Error('getRateLimiter not implemented.');\n  }\n\n  // Token validation\n  validateAuthToken(token: string): Promise<boolean> {\n    throw new Error('validateAuthToken not implemented.');\n  }\n\n  // Data encryption\n  encryptSensitiveData(data: string): string {\n    throw new Error('encryptSensitiveData not implemented.');\n  }\n\n  decryptSensitiveData(encryptedData: string): string {\n    throw new Error('decryptSensitiveData not implemented.');\n  }\n\n  // Hash generation\n  generateHash(data: string): string {\n    return createHash('sha256').update(data).digest('hex');\n  }\n\n  // Secure random token generation\n  generateSecureToken(length = 32): string {\n    return randomBytes(length).toString('hex');\n  }\n\n  // Security headers\n  getSecurityHeaders() {\n    return {\n      'Strict-Transport-Security': 'max-age=31536000; includeSubDomains',\n      'X-Frame-Options': 'DENY',\n      'X-Content-Type-Options': 'nosniff',\n      'Referrer-Policy': 'strict-origin-when-cross-origin',\n      'Content-Security-Policy': this.getCSP(),\n      'Permissions-Policy': this.getPermissionsPolicy(),\n    };\n  }\n\n  private getCSP(): string {\n    return [\n      \"default-src 'self'\",\n      \"script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.segment.com\",\n      \"style-src 'self' 'unsafe-inline' https://fonts.googleapis.com\",\n      \"img-src 'self' data: https:\",\n      \"font-src 'self' https://fonts.gstatic.com\",\n      \"connect-src 'self' https://api.segment.io\",\n      \"frame-ancestors 'none'\",\n      \"base-uri 'self'\",\n      \"form-action 'self'\",\n    ].join('; ');\n  }\n\n  private getPermissionsPolicy(): string {\n    return [\n      'camera=()',\n      'microphone=()',\n      'geolocation=()',\n      'interest-cohort=()',\n    ].join(', ');\n  }\n\n  // Compliance checks\n  validateDataPrivacy(data: any): boolean {\n    // Implement GDPR/CCPA compliance checks\n    const sensitiveFields = ['ssn', 'creditCard', 'password'];\n    return !Object.keys(data).some(key => sensitiveFields.includes(key));\n  }\n\n  // Security logging\n  logSecurityEvent(event: string, details: any) {\n    console.log('[SECURITY]', {\n      timestamp: new Date().toISOString(),\n      event,\n      details,\n    });\n  }\n}\n\nexport const security = SecurityService.getInstance({\n  rateLimitRequests: 100,\n  rateLimitWindowMs: 15 * 60 * 1000, // 15 minutes\n  encryptionKey: process.env.ENCRYPTION_KEY || '',\n  jwtSecret: process.env.JWT_SECRET || '',\n}); "],"mappings":";AAAA,SAAS,YAAY,mBAAmB;AASxC,IAAM,kBAAN,MAAM,iBAAgB;AAAA,EAIZ,YAAY,QAAwB;AAC1C,SAAK,SAAS;AAAA,EAChB;AAAA,EAEA,OAAO,YAAY,QAAyC;AAC1D,QAAI,CAAC,iBAAgB,UAAU;AAC7B,uBAAgB,WAAW,IAAI,iBAAgB,MAAM;AAAA,IACvD;AACA,WAAO,iBAAgB;AAAA,EACzB;AAAA;AAAA,EAGA,kBAAkB,OAAiB;AACjC,UAAM,IAAI,MAAM,oCAAoC;AAAA,EACtD;AAAA;AAAA,EAGA,iBAAiB;AACf,UAAM,IAAI,MAAM,iCAAiC;AAAA,EACnD;AAAA;AAAA,EAGA,kBAAkB,OAAiC;AACjD,UAAM,IAAI,MAAM,oCAAoC;AAAA,EACtD;AAAA;AAAA,EAGA,qBAAqB,MAAsB;AACzC,UAAM,IAAI,MAAM,uCAAuC;AAAA,EACzD;AAAA,EAEA,qBAAqB,eAA+B;AAClD,UAAM,IAAI,MAAM,uCAAuC;AAAA,EACzD;AAAA;AAAA,EAGA,aAAa,MAAsB;AACjC,WAAO,WAAW,QAAQ,EAAE,OAAO,IAAI,EAAE,OAAO,KAAK;AAAA,EACvD;AAAA;AAAA,EAGA,oBAAoB,SAAS,IAAY;AACvC,WAAO,YAAY,MAAM,EAAE,SAAS,KAAK;AAAA,EAC3C;AAAA;AAAA,EAGA,qBAAqB;AACnB,WAAO;AAAA,MACL,6BAA6B;AAAA,MAC7B,mBAAmB;AAAA,MACnB,0BAA0B;AAAA,MAC1B,mBAAmB;AAAA,MACnB,2BAA2B,KAAK,OAAO;AAAA,MACvC,sBAAsB,KAAK,qBAAqB;AAAA,IAClD;AAAA,EACF;AAAA,EAEQ,SAAiB;AACvB,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF,EAAE,KAAK,IAAI;AAAA,EACb;AAAA,EAEQ,uBAA+B;AACrC,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF,EAAE,KAAK,IAAI;AAAA,EACb;AAAA;AAAA,EAGA,oBAAoB,MAAoB;AAEtC,UAAM,kBAAkB,CAAC,OAAO,cAAc,UAAU;AACxD,WAAO,CAAC,OAAO,KAAK,IAAI,EAAE,KAAK,SAAO,gBAAgB,SAAS,GAAG,CAAC;AAAA,EACrE;AAAA;AAAA,EAGA,iBAAiB,OAAe,SAAc;AAC5C,YAAQ,IAAI,cAAc;AAAA,MACxB,YAAW,oBAAI,KAAK,GAAE,YAAY;AAAA,MAClC;AAAA,MACA;AAAA,IACF,CAAC;AAAA,EACH;AACF;AAEO,IAAM,WAAW,gBAAgB,YAAY;AAAA,EAClD,mBAAmB;AAAA,EACnB,mBAAmB,KAAK,KAAK;AAAA;AAAA,EAC7B,eAAe,QAAQ,IAAI,kBAAkB;AAAA,EAC7C,WAAW,QAAQ,IAAI,cAAc;AACvC,CAAC;","names":[]}